
<!DOCTYPE html>
<html>
<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300' rel='stylesheet' type='text/css'>
<style>@font-face{font-family:'weather';src:url('//mg.masonx.tk/weather/artill.eot');src:url('//mg.masonx.tk/weather/artill.woff') format('woff'),url('//mg.masonx.tk/weather/artill.ttf') format('truetype'),url('//mg.masonx.tk/weather/artill.svg') format('svg');font-weight:normal;font-style:normal;}html{width:100%;height:100%;background:#000;background-size:cover;-webkit-font-smoothing:antialiased!important;}body{padding:45px 0;font:20px 'Open Sans',"Helvetica Neue",Helvetica,Arial,"Lucida Grande",sans-serif;width:800px;margin:0px auto;text-align:center;color:#fff;font-weight:300;}#weather{text-transform:uppercase;}#weather i{color:#fff;font-family:weather;font-size:160px;font-weight:normal;font-style:normal;line-height:1.0;text-shadow:3px 3px 3px #666;}#stock i{font-size:50px;font-family:weather;font-weight:normal;font-style:normal;line-height:1.0;}.icon-0:before{content:":";}.icon-1:before{content:"p";}.icon-2:before{content:"S";}.icon-3:before{content:"Q";}.icon-4:before{content:"S";}.icon-5:before{content:"W";}.icon-6:before{content:"W";}.icon-7:before{content:"W";}.icon-8:before{content:"W";}.icon-9:before{content:"I";}.icon-10:before{content:"W";}.icon-11:before{content:"I";}.icon-12:before{content:"I";}.icon-13:before{content:"I";}.icon-14:before{content:"I";}.icon-15:before{content:"W";}.icon-16:before{content:"I";}.icon-17:before{content:"W";}.icon-18:before{content:"U";}.icon-19:before{content:"Z";}.icon-20:before{content:"Z";}.icon-21:before{content:"Z";}.icon-22:before{content:"Z";}.icon-23:before{content:"Z";}.icon-24:before{content:"E";}.icon-25:before{content:"E";}.icon-26:before{content:"3";}.icon-27:before{content:"a";}.icon-28:before{content:"A";}.icon-29:before{content:"a";}.icon-30:before{content:"A";}.icon-31:before{content:"6";}.icon-32:before{content:"1";}.icon-33:before{content:"6";}.icon-34:before{content:"1";}.icon-35:before{content:"W";}.icon-36:before{content:"1";}.icon-37:before{content:"S";}.icon-38:before{content:"S";}.icon-39:before{content:"S";}.icon-40:before{content:"M";}.icon-41:before{content:"W";}.icon-42:before{content:"I";}.icon-43:before{content:"W";}.icon-44:before{content:"a";}.icon-45:before{content:"S";}.icon-46:before{content:"U";}.icon-47:before{content:"S";}.icon-up:before{content:"[";}.icon-do:before{content:"]";}h1,#weather h2{margin:0;color:#fff;font-size:100px;font-weight:300;text-align:center;text-shadow:3px 3px 3px #666;}#weather li{background:#fff;background:rgba(255,255,255,1);padding:10px;display:inline-block;border-radius:5px;color:#000;font-weight:400;text-shadow:none;margin:-5px;}button{margin:15px auto;width:600px;padding:5px;background:transparent;color:#fff;border:0;border-radius:5px;font:20px 'Open Sans',"Helvetica Neue",Helvetica,Arial,"Lucida Grande",sans-serif;}#stock{background:#fff;background:rgba(255,255,255,0.90);padding:20px;display:inline-block;border-radius:5px;color:#000;font-weight:400;text-shadow:none;}.spinner{margin:100px auto 0;width:70px;text-align:center;}.spinner>div{width:18px;height:18px;background-color:#333;border-radius:100%;display:inline-block;-webkit-animation:bouncedelay 1.4s infinite ease-in-out;animation:bouncedelay 1.4s infinite ease-in-out;-webkit-animation-fill-mode:both;animation-fill-mode:both;}.spinner .bounce1{-webkit-animation-delay:-0.32s;animation-delay:-0.32s;}.spinner .bounce2{-webkit-animation-delay:-0.16s;animation-delay:-0.16s;}@-webkit-keyframes bouncedelay{0%,80%,100%{-webkit-transform:scale(0.0)}40%{-webkit-transform:scale(1.0)}}@keyframes bouncedelay{0%,80%,100%{transform:scale(0.0);-webkit-transform:scale(0.0);}40%{transform:scale(1.0);-webkit-transform:scale(1.0);}}</style>
</head>
<body>
It is currently
<h1 id="txt">
<div class="spinner">
<div class="bounce1"></div>
<div class="bounce2"></div>
<div class="bounce3"></div>
</div></h1>
<div id="msg"></div>
<br/> Current stocks, last updated <span id="stockupdatetime">never</span>, are
<br/>
<div id="stock">
<div class="spinner">
<div class="bounce1"></div>
<div class="bounce2"></div>
<div class="bounce3"></div>
</div>
</div>
<br/> Current weather, last updated <span id="weatherupdatetime">never</span>, are
<br/>
<div id="weather">
<div class="spinner">
<div class="bounce1"></div>
<div class="bounce2"></div>
<div class="bounce3"></div>
</div>
</div>
<div id="intro">
</div>
<button class="js-geolocation" style="display: none;">Click here to use your more precise location.</button>
<script src='//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js'></script>
<script src='//mg.masonx.tk/weather/simpleweather.min.js'></script>
<script src='//cdn.rawgit.com/carhartl/jquery-cookie/master/src/jquery.cookie.js'></script>
<script>
        var loc = 'unknown';
        var today = new Date();
        var h, m, s;
        $('.js-geolocation').on('click', function() {
            console.log("HTML5 Geolocation selected");
            navigator.geolocation.getCurrentPosition(function(position) {
                loc = position.coords.latitude + ',' + position.coords.longitude;
                loadWeather(); //load weather using your lat/lng coordinates
                $("#intro").html('Location: ' + position.coords.latitude + ',' + position.coords.longitude + ' (Found using HTML5 Geolocation)');
                $('.js-geolocation').hide();
                console.log("Location found! (" + position.coords.latitude + ',' + position.coords.longitude + ")");
            });
        });
        var sub = "AM"

        function startTime() {
            today = new Date();
            h = today.getHours();
            m = today.getMinutes();
            s = today.getSeconds();
            console.log(h);
                    if ((h>=22)||h<=5){
                        $("#msg").html("go to sleep! it's late now! :)");
                    }
            m = checkTime(m);
            s = checkTime(s);
            h = apm(h);
            $("#txt").html(h + ":" + m + ":" + s+" "+sub);
            document.title = h + ":" + m + " " + sub;
            var t = setTimeout(function() {startTime()}, 500);
        }

        function checkTime(i) {
                if (i < 10) {
                    i = "0" + i
                }; // add zero in front of numbers < 10
                return i;
            }
            //am or pm
        function apm(i) {
            if (i > 12) {
                i = i - 12;
                sub = "PM"
            }
            return i;
        }

        function loadWeather() {
            $.simpleWeather({
                location: loc,
                woeid: '',
                unit: 'c',
                success: function(weather) {
                    html = '<h2><i class="icon-' + weather.code + '"></i> ' + weather.temp + '&deg;' + weather.units.temp + '</h2>';
                    html += '<ul><li>' + weather.city + ', ' + weather.region + '</li>';
                    html += '<li class="currently">' + weather.currently + '</li>';
                    html += '<li>High:' + weather.high + '&deg;C</li>';
                    html += '<li>Low: ' + weather.low + '&deg;C</li></ul>';
                    $("#weather").html(html);
                    $("#weatherupdatetime").html(h + ":" + m + ":" + s);
                },
                error: function(error) {
                    $("#weather").html('<p>' + error + '</p>');
                }
            });
        }

        function StockPriceTicker() {
            var Symbol = "",
                CompName = "",
                Price = "",
                ChnageInPrice = "",
                PercentChnageInPrice = "";
            var CNames = "CADUSD=X,GOOG,MSFT,AAPL,AMD";
            var flickerAPI = "http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20yahoo.finance.quotes%20where%20symbol%20in%20(%22" + CNames + "%22)&env=store://datatables.org/alltableswithkeys";
            var StockTickerHTML = "";

            var StockTickerXML = $.get(flickerAPI, function(xml) {
                $(xml).find("quote").each(function() {
                    Symbol = $(this).attr("symbol");
                    $(this).find("Name").each(function() {
                        CompName = Symbol == "AMD" ? "Advanced Micro Devices" : ($(this).text() == "CAD/USD" ? "Canadian Dollar" : $(this).text());
                    });
                    $(this).find("LastTradePriceOnly").each(function() {
                        Price = $(this).text();
                    });
                    $(this).find("Change").each(function() {
                        ChangeInPrice = $(this).text();
                    });
                    $(this).find("PercentChange").each(function() {
                        PercentChangeInPrice = $(this).text();
                    });

                    var PriceColor = "#00ad00",
                        PriceIcon = "icon-up";
                    if (parseFloat(ChangeInPrice) < 0) {
                        PriceColor = "#ff0000";
                        PriceIcon = "icon-do";
                    }
                    StockTickerHTML += "<span class='quote'>" + CompName + " (" + Symbol + ")</span> ";
                    StockTickerHTML += "<span style='color:" + PriceColor + "'>";
                    StockTickerHTML += parseFloat(Price).toFixed(2) + " ";
                    StockTickerHTML += "<i class='" + PriceIcon + "'></i>" + parseFloat(Math.abs(ChangeInPrice)).toFixed(2) + " (";
                    StockTickerHTML += parseFloat(Math.abs(PercentChangeInPrice.split('%')[0])).toFixed(2) + "%)</span><br />";
                });

                $("#stock").html(StockTickerHTML);
                $("#stockupdatetime").html(h + ":" + m + ":" + s);
            });
        }
        $(document).ready(function() {
            if ("geolocation" in navigator) {
                $('.js-geolocation').show();
            } else {
                $('.js-geolocation').hide();
            }

            startTime();
            StockPriceTicker();
            setInterval(function() {
                StockPriceTicker();
            }, 5000);
            /*Nested like this so that each item is called one after another*/
            $.get("http://ipinfo.io/city", function(data, status) {
                loc = data.replace(/(\r\n|\n|\r)/gm, "");
                $.get("http://ipinfo.io/region", function(data, status) {
                    loc = loc + ", " + data.replace(/(\r\n|\n|\r)/gm, "");
                    $("#intro").html('Location: ' + loc + ' (determined by your IP)');
                    loadWeather();
                    setInterval(function() {
                        loadWeather();
                    }, 600000);
                });
            });
        });
    </script>
</body>
</html> 
